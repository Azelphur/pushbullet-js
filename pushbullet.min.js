var PushBullet=function(){var e={},t="https://api.pushbullet.com/v2/",r=t+"pushes",n=t+"contacts",a=t+"devices",o=t+"users/me",i=t+"upload-request",u=4,s=200,l=204;e.APIKey=null,e.push=function(e,t,n,a,o){var i={type:e.toLowerCase()};if(n&&t){var u=new Error("Cannot push to both device and contact");if(o)return o(u);throw u}if(n)i.email=n;else{if(!t){var u=new Error("Must push to either device or contact");if(o)return o(u);throw u}i.device_iden=t}switch(e.toLowerCase()){case"note":i.title=a.title,i.body=a.body;break;case"link":i.title=a.title,i.url=a.url,a.body&&(i.body=a.body);break;case"address":i.name=a.name,i.address=a.address;break;case"list":i.title=a.title,i.items=a.items;break;default:var u=new Error("Invalid type");if(o)return o(u);throw u}var s=c(r,"POST",i,!1,o);return o?void 0:s},e.pushFile=function(e,t,r,n,a){var o="file_type="+encodeURIComponent(r.type),u="file_name="+encodeURIComponent(r.name),s=i+"?"+o+"&"+u,l=a?function(o,i){if(o)return a(o);try{d(i,e,t,r,n,a)}catch(o){return a(o)}}:null,p=c(s,"GET",null,!1,l);return a?void 0:d(p,e,t,r,n)};var d=function(e,t,n,a,o,i){var u=new FormData;u.append("awsaccesskeyid",e.data.awsaccesskeyid),u.append("acl",e.data.acl),u.append("key",e.data.key),u.append("signature",e.data.signature),u.append("policy",e.data.policy),u.append("content-type",a.type),u.append("file",a),c(e.upload_url,"POST",u,!0,null);var s={file_name:a.name,file_type:a.type,file_url:e.file_url,type:"file"};if(o&&(s.body=o),n&&t){var l=new Error("Cannot push to both device and contact");if(i)return i(l);throw l}if(n)s.email=n;else{if(!t){var l=new Error("Must push to either device or contact");if(i)return i(l);throw l}s.device_iden=t}var d=c(r,"POST",s,!1,i);return i?void 0:d};e.deletePush=function(e,t){var n=c(r+"/"+e,"DELETE",null,!1,t);return t?void 0:n},e.pushHistory=function(e){var t=c(r,"GET",null,!1,e);return e?void 0:t},e.devices=function(e){var t=c(a,"GET",null,!1,e);return e?void 0:t},e.deleteDevice=function(e,t){var r=c(a+"/"+e,"DELETE",null,!1,t);return t?void 0:r},e.contacts=function(e){var t=c(n,"GET",null,!1,e);return e?void 0:t},e.deleteContact=function(e,t){var r=c(n+"/"+e,null,!1,t);return t?void 0:r},e.user=function(e){var t=c(o,"GET",null,!1,e);return e?void 0:t};var c=function(t,r,n,a,o){if(!e.APIKey){var i=new Error("API Key for Pushbullet not set");if(o)return o(i);throw i}var s=new XMLHttpRequest,l=!1;return o&&(l=!0,s.onreadystatechange=function(){if(s.readyState===u){var e=null;try{e=p(s)}catch(t){return o(t)}return o(null,e)}}),s.open(r,t,l),a||(s.setRequestHeader("Authorization","Basic "+window.btoa(e.APIKey+":")),s.setRequestHeader("Content-Type","application/json"),n=JSON.stringify(n)),s.send(n),l?void 0:p(s)},p=function(e){if(e.status!==s&&e.status!==l)throw new Error(e.status+": "+e.response);try{return JSON.parse(e.response)}catch(t){return e.response}};return e}();
